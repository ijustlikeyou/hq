<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:include="include :: header('新增瀚淇订单')" />
    <th:block th:include="include :: datetimepicker-css" />
</head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-form-add">
            <div class="form-group">
                <label class="col-sm-3 control-label">运抵国（地区）：</label>
                <div class="col-sm-8">
                    <input name="shippingAddress" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">贸易国（地区）：</label>
                <div class="col-sm-8">
                    <input name="destination" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">收货公司：</label>
                <div class="col-sm-8">
                    <input name="receivingCompany" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">单号：</label>
                <div class="col-sm-8">
                    <input name="formId" class="form-control" type="text">
                </div>
            </div>
             <div class="form-group">    
                <label class="col-sm-3 control-label">尺码：</label>
                  <div class="col-sm-8">
                     <input name="standby01" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">美元汇率：</label>
                <div class="col-sm-8">
                    <input name="dollarCurrencyRate" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">运费：</label>
                <div class="col-sm-8">
                    <input name="standby03" class="form-control" type="text">
                </div>
            </div>
          <!--   <div class="form-group">    
                <label class="col-sm-3 control-label">退税率：</label>
                <div class="col-sm-8">
                    <select name="taxRefundRate" class="form-control m-b" th:with="type=${@dict.getType('hq_tax_refund_rate')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div> -->
            <div class="form-group">    
                <label class="col-sm-3 control-label">订单类型：</label>
                <div class="col-sm-8">
                    <select name="formType" class="form-control m-b" th:with="type=${@dict.getType('product_type')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">指运港：</label>
                  <div class="col-sm-8">
                    <select name="portOfDestination" class="form-control m-b" th:with="type=${@dict.getType('hq_port_of_destination')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
           
            <div class="form-group">    
                <label class="col-sm-3 control-label">离境口岸：</label>
                <div class="col-sm-8">
                    <select name="portOfDeparture" class="form-control m-b" th:with="type=${@dict.getType('hq_port_of_departure')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">成交方式：</label>
                <div class="col-sm-8">
                    <select name="termsOfDelivery" class="form-control m-b" th:with="type=${@dict.getType('termsDelivery')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">包装种类：</label>
                <div class="col-sm-8">
                    <select name="kindOfPackage" class="form-control m-b" th:with="type=${@dict.getType('package')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">运输方式：</label>
                <div class="col-sm-8">
                    <select name="transportation" class="form-control m-b" th:with="type=${@dict.getType('transportation')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">境内发货人：</label>
                <div class="col-sm-8">
                    <select name="consigner" class="form-control m-b" th:with="type=${@dict.getType('consigner')}">
                        <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}">
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">境内发货人：</label>
                <div class="col-sm-8">
                     <input id="filePath" name="filePath" class="form-control" type="file">
                </div>
            </div>
            <input id="excelFilePath" name="excelFilePath" class="form-control" type="hidden">       
        </form>
    </div>
    <th:block th:include="include :: footer" />
    <th:block th:include="include :: datetimepicker-js" />
    <script type="text/javascript">
        
      /*   form表单value值初始化 */
      initForm();
        function initForm(){
        	$('input[name="destination"],input[name="shippingAddress"]').val("尼日利亚");
        }
        var prefix = ctx + "hq/form"
        $("#form-form-add").validate({
            focusCleanup: true
        });
       
        function submitHandler() {
        
            if ($.validate.form()) {
            	uploadFile()
            }
        }
        
        function uploadFile() {
        	var formData = new FormData();
        	if ($('#filePath')[0].files[0] == null) {
        		$.modal.alertWarning("请先选择文件路径");
        		return false;
        	}
        	var fileName=$('#filePath')[0].files[0].name;
        	var fileType=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length);
            if(fileType!="xls"&&fileType!="xlsx"){
            	$.modal.alertWarning("请上传xls或者xlsx格式类型的文件！");
            	return;
            }
        	formData.append('fileName',fileName);
        	formData.append('file', $('#filePath')[0].files[0]);
        	$.ajax({
        		url: prefix + "/addFile",
        		type: 'post',
        		cache: false,
        		data: formData,
        		processData: false,
        		contentType: false,
        		dataType: "json",
        		success: function(result) {
        			if(result.code==0){
        				fileState=true;
        				$("#excelFilePath").val(result.filePath);
        				$.operate.save(prefix + "/add", $('#form-form-add').serialize());
        			}else{
        				$.modal.alertError(result.error);
        			}
        		}
        	});
        }

        $("input[name='createDate']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });

        $("input[name='lastUpdateDate']").datetimepicker({
            format: "yyyy-mm-dd",
            minView: "month",
            autoclose: true
        });
    </script>
</body>
</html>